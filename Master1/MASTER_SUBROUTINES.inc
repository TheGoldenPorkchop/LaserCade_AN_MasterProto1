;************************************************************************************
;										    *
;   Filename:	    MASTER_SUBROUTINES.inc					    *
;   Date:	    April 22, 2025						    *
;   File Version:   2								    *
;   Author:	    Alex Wheelock and Andrew Keller				    *
;   Company:	    Idaho State University					    *
;   Description:    Contains all subroutines needed for the Laser Shooting Game     *
;		    project. Subroutines include the ability to communicate via	    *
;		    UART for control, I2C write/read, and updating each target	    *
;		    slot for I2C enabling, disabling or polling.		    *
;										    *
;************************************************************************************

;************************************************************************************
;										    *
;   Revision History:								    *
;										    *
;   1:	Initialize file, get everything working the way that I thought it should    *
;	work.									    *
;   2:	Update to include UART and I2C for up to eight different targets active     *
;	simultaneously.								    *
;										    *
;************************************************************************************		
	    
//SUBROUTINES_CODE CODE
  PSECT code
    ;WRITES THE DATA STORED IN WRITE_DATA TO THE I2C ADDRESS IN CURRENT_ADDRESS
    WRITE_I2C:
	    CALL	    I2CIDLE		;ENSURE THAT THE I2C LINES ARE IDLE
	    BANKSEL	    SSP1CON2
	    BSF		    SSP1CON2,0
	    BTFSC	    SSP1CON2,0		;WAIT UNTIL START CONDITION IS COMPLETE
	    GOTO	    $-1
	    BANKSEL	    PORTA
	    MOVF	    CURRENT_ADDRESS, 0	;SEND I2C ADDRESS OUT 
	    BANKSEL	    SSP1BUF
	    MOVWF	    SSP1BUF
	    BANKSEL	    SSP1STAT
	    BTFSC	    SSP1STAT,0		;WAIT UNTIL ALL DATA HAS BEEN SHIFTED OUT OF SSPBUF
	    GOTO	    $-1
	    CALL	    I2CIDLE		;ENSURE THAT THE I2C LINES ARE IDLE
	    BANKSEL	    SSP1CON2
	    BTFSC	    SSP1CON2,6		;DETERMINE IF THERE IS AN ACK FROM THE SLAVE
	    GOTO	    BAD1		;NACK FROM THE SLAVE, STOP COMMUNICATION
	    BANKSEL	    PORTA
	    MOVF	    WRITE_DATA, W
	    BANKSEL	    SSP1BUF
	    MOVWF	    SSP1BUF		;TRANSMIT DATA TO SLAVE
	    BANKSEL	    SSP1STAT
	    BTFSC	    SSP1STAT,0		;WAIT UNTIL ALL DATA HAS BEEN SHIFTED OUT OF SSPBUF
	    GOTO	    $-1
	    CALL	    I2CIDLE		;ENSURE THAT THE I2C LINES ARE IDLE
	    BANKSEL	    SSP1CON2
	    BTFSC	    SSP1CON2,6		;DETERMINE IF THERE IS AN ACK FROM THE SLAVE
	    GOTO	    BAD1		;NACK FROM THE SLAVE, STOP COMMUNICATION
	    BSF		    SSP1CON2,2		;CREATE STOP CONDITION
	    BTFSC	    SSP1CON2,2
	    GOTO	    $-1			;WAIT FOR STOP CONDITION TO COMPLETE
	    BANKSEL	    PORTA
	    RETURN
	    
    ;WRITES THE DATA STORED IN WRITE_DATA TO THE I2C ADDRESS IN CURRENT_ADDRESS
    WRITE_COLOR_I2C:
	    CALL	    I2CIDLE		;ENSURE THAT THE I2C LINES ARE IDLE
	    BANKSEL	    SSP1CON2
	    BSF		    SSP1CON2,0
	    BTFSC	    SSP1CON2,0		;WAIT UNTIL START CONDITION IS COMPLETE
	    GOTO	    $-1
	    BANKSEL	    PORTA
	    MOVLW	    0x00		;SEND I2C ADDRESS OUT 
	    BANKSEL	    SSP1BUF
	    MOVWF	    SSP1BUF
	    BANKSEL	    SSP1STAT
	    BTFSC	    SSP1STAT,0		;WAIT UNTIL ALL DATA HAS BEEN SHIFTED OUT OF SSPBUF
	    GOTO	    $-1
	    CALL	    I2CIDLE		;ENSURE THAT THE I2C LINES ARE IDLE
	    BANKSEL	    SSP1CON2
	    BTFSC	    SSP1CON2,6		;DETERMINE IF THERE IS AN ACK FROM THE SLAVE
	    GOTO	    BAD1		;NACK FROM THE SLAVE, STOP COMMUNICATION
	    BANKSEL	    PORTA
	    MOVLW	    0x43
	    BANKSEL	    SSP1BUF
	    MOVWF	    SSP1BUF		;TRANSMIT DATA TO SLAVE
	    BANKSEL	    SSP1STAT
	    BTFSC	    SSP1STAT,0		;WAIT UNTIL ALL DATA HAS BEEN SHIFTED OUT OF SSPBUF
	    GOTO	    $-1
	    CALL	    I2CIDLE		;ENSURE THAT THE I2C LINES ARE IDLE
	    BANKSEL	    SSP1CON2
	    BTFSC	    SSP1CON2,6		;DETERMINE IF THERE IS AN ACK FROM THE SLAVE
	    GOTO	    BAD1		;NACK FROM THE SLAVE, STOP COMMUNICATION
	    BANKSEL	    PORTA
	    MOVF	    PLAYER_NUMBER, W
	    BANKSEL	    SSP1BUF
	    MOVWF	    SSP1BUF		;TRANSMIT DATA TO SLAVE
	    BANKSEL	    SSP1STAT
	    BTFSC	    SSP1STAT,0		;WAIT UNTIL ALL DATA HAS BEEN SHIFTED OUT OF SSPBUF
	    GOTO	    $-1
	    CALL	    I2CIDLE		;ENSURE THAT THE I2C LINES ARE IDLE
	    BANKSEL	    SSP1CON2
	    BTFSC	    SSP1CON2,6		;DETERMINE IF THERE IS AN ACK FROM THE SLAVE
	    GOTO	    BAD1		;NACK FROM THE SLAVE, STOP COMMUNICATION
	    BANKSEL	    PORTA
	    MOVF	    GREEN, W
	    BANKSEL	    SSP1BUF
	    MOVWF	    SSP1BUF		;TRANSMIT DATA TO SLAVE
	    BANKSEL	    SSP1STAT
	    BTFSC	    SSP1STAT,0		;WAIT UNTIL ALL DATA HAS BEEN SHIFTED OUT OF SSPBUF
	    GOTO	    $-1
	    CALL	    I2CIDLE		;ENSURE THAT THE I2C LINES ARE IDLE
	    BANKSEL	    SSP1CON2
	    BTFSC	    SSP1CON2,6		;DETERMINE IF THERE IS AN ACK FROM THE SLAVE
	    GOTO	    BAD1		;NACK FROM THE SLAVE, STOP COMMUNICATION
	    BANKSEL	    PORTA
	    MOVF	    RED, W
	    BANKSEL	    SSP1BUF
	    MOVWF	    SSP1BUF		;TRANSMIT DATA TO SLAVE
	    BANKSEL	    SSP1STAT
	    BTFSC	    SSP1STAT,0		;WAIT UNTIL ALL DATA HAS BEEN SHIFTED OUT OF SSPBUF
	    GOTO	    $-1
	    CALL	    I2CIDLE		;ENSURE THAT THE I2C LINES ARE IDLE
	    BANKSEL	    SSP1CON2
	    BTFSC	    SSP1CON2,6		;DETERMINE IF THERE IS AN ACK FROM THE SLAVE
	    GOTO	    BAD1		;NACK FROM THE SLAVE, STOP COMMUNICATION
	    BANKSEL	    PORTA
	    MOVF	    BLUE, W
	    BANKSEL	    SSP1BUF
	    MOVWF	    SSP1BUF		;TRANSMIT DATA TO SLAVE
	    BANKSEL	    SSP1STAT
	    BTFSC	    SSP1STAT,0		;WAIT UNTIL ALL DATA HAS BEEN SHIFTED OUT OF SSPBUF
	    GOTO	    $-1
	    CALL	    I2CIDLE		;ENSURE THAT THE I2C LINES ARE IDLE
	    BANKSEL	    SSP1CON2
	    BTFSC	    SSP1CON2,6		;DETERMINE IF THERE IS AN ACK FROM THE SLAVE
	    GOTO	    BAD1		;NACK FROM THE SLAVE, STOP COMMUNICATION
	    BSF		    SSP1CON2,2		;CREATE STOP CONDITION
	    BTFSC	    SSP1CON2,2
	    GOTO	    $-1			;WAIT FOR STOP CONDITION TO COMPLETE
	    BANKSEL	    PORTA
	    RETURN	    
	    
    ;REQUESTS THE CURRENT STATUS OF THE TARGET FOUND AT CURRENT_ADDRESS
    READ_TARGET_STATUS:
	    CALL	    I2CIDLE		;ENSURE THAT THE I2C LINES ARE IDLE
	    BANKSEL	    SSP1CON2
	    BSF		    SSP1CON2,0
	    BTFSC	    SSP1CON2,0		;WAIT UNTIL START CONDITION IS COMPLETE
	    GOTO	    $-1
	    BANKSEL	    PORTA
	    MOVF	    CURRENT_ADDRESS, W	;SEND I2C ADDRESS OUT 
	    ADDLW	    0X01		;CONVERT THE WRITE ADDRESS TO THE READ ADDRESS
	    BANKSEL	    SSP1BUF
	    MOVWF	    SSP1BUF
	    BANKSEL	    SSP1STAT
	    BTFSC	    SSP1STAT,0		;WAIT UNTIL ALL DATA HAS BEEN SHIFTED OUT OF SSPBUF
	    GOTO	    $-1
	    CALL	    I2CIDLE		;ENSURE THAT THE I2C LINES ARE IDLE
	    BANKSEL	    SSP1CON2
	    BTFSC	    SSP1CON2,6		;DETERMINE IF THERE IS AN ACK FROM THE SLAVE
	    GOTO	    BAD1
	    BSF		    SSP1CON2,3		;ENABLE RCEN TO RECEIVE DATA FROM THE SLAVE
	    BANKSEL	    SSP1STAT
	    BTFSS	    SSP1STAT,0		;WAIT UNTIL ALL DATA HAS BEEN SHIFTED INTO SSPBUF FROM THE SLAVE
	    GOTO	    $-1
	    BANKSEL	    SSP1BUF		;\
	    MOVFW	    SSP1BUF		;\\READ STATUS OF CURRENT TARGET
	    BANKSEL	    PORTA		;//STORE BYTE INTO RECEIVED_BYTE REGISTER
	    MOVWF	    RECEIVED_BYTE	;/
	    BANKSEL	    SSP1CON2
	    BSF		    SSP1CON2,2		;CREATE STOP CONDITION
	    BTFSC	    SSP1CON2,2
	    GOTO	    $-1			;WAIT FOR STOP CONDITION TO COMPLETE
	    CALL	    TEST_SCORE		;TEST TO SEE IF A PLAYER HAS SCORED
	    RETURN
	    
    ;TESTS THE SCORE BASED RECEIVED_BYTE
    TEST_SCORE:
	    ;PLAYER1 = 0x0F
	    ;PLAYER2 = 0xF0
	    ;NO SCORE = 0x00
	    
	    ;SEND OUT TO EUART!
	    
	    BANKSEL	    TX1REG
	    BTFSC	    TRMT
	    GOTO	    $-1
	    MOVLW	    0x24 ;SENDS THE DOLLAR HANDSHAKE
	    MOVWF	    TX1REG

	    BTFSC	    TRMT
	    GOTO	    $-1
	    MOVLW	    0x52 ;R
	    MOVWF	    TX1REG
	    
	    BANKSEL	    PORTA
	    MOVF	    RECEIVED_BYTE, W
	    BANKSEL	    TX1REG
	    BTFSC	    TRMT
	    GOTO	    $-1
	    MOVWF	    TX1REG
	    RETURN				;NEITHER PLAYER SCORED, RETURN

	    
    ;VERIFIES THAT THE I2C LINES ARE IDLE
    I2CIDLE:	
	    MOVLW	    0X1F		;Load Bus Test Value
	    BANKSEL	    SSP1CON2		
	    ANDWF	    SSP1CON2,W		;Compare 1F to check for 5 busy conditions
	    BANKSEL	    STATUS
	    BTFSS	    STATUS,2		;Test Zero Bit STATUS,Z
	    GOTO	    I2CIDLE		;Z=0  Bus is still busy -repeat
	CHECKR_W:				;Z=1 Not Busy
	    BANKSEL	    SSP1STAT
	    BTFSC	    SSP1STAT,2		;see if SSP is transmitting data
	    GOTO	    CHECKR_W		;R_W = 1 - Still transmitting data
	    RETURN				;R_W = 0 - Transmit done

    ;BAD I2C STATE, GENERATES A STOP CONDITION
    BAD1:	
	    MOVLW	    0XFF		;SET RETURN CODE TO -1
	    BANKSEL	    SSP1CON2
	    BSF PEN	;GENERATE A STOP CONDITION
	LOOP5:
	    BTFSC PEN	;IS STOP CONDITION DONE
	    GOTO	    LOOP5
	    
	    BANKSEL	    TX1REG
	    BTFSC	    TRMT
	    GOTO	    $-1
	    MOVLW	    0x24 ;SENDS THE DOLLAR HANDSHAKE
	    MOVWF	    TX1REG

	    BTFSC	    TRMT
	    GOTO	    $-1
	    MOVLW	    0x46 ;F FOR FAIL
	    MOVWF	    TX1REG
	    
	    RETURN
	    
    ;WHEN UART IS RECEIVED, DETERMINES IF IT IS THE CORRECT DEVICE AND HOW TO RESPOND
    UARTRX:
	    BANKSEL	    PORTA
	    BTFSC	    UART_MODE, 7	;IF HANDSHAKE ALREADY RECEIVED, GOTO INTERPRETCOMMAND
	    GOTO	    INTERPRETUART
	    BANKSEL	    RC1REG		;ELSE CHECK RECEIVED BYTE FOR HANDSHAKE
	    MOVF	    RC1REG, 0
	    XORLW	    0X24		;COMPARE RECEIVED BYTE WITH $
	    BANKSEL	    PORTA
	    BTFSC	    STATUS,2		;IF RECEIVED MATCHES $, SET HNDSK FLAG IN UART_RX_MODE STATUS,Z
	    BSF		    UART_MODE, 7
	    RETURN
	    
	;THE HANDSHAKE BYTE WAS RECEIVED PREVIOUSLY, CHECK THE NEW BYTE FOR THE COMMAND TO EXECUTE
	INTERPRETUART:
	    BANKSEL	    PORTA
	    BCF		    UART_MODE, 7	;CLEAR THE HNDSK FLAG
	    BANKSEL	    RC1REG
	    MOVF	    RC1REG, W
	    MOVWF	    UART_RX_BYTE	;STORE RECEIVED BYTE IN UART_RX_BYTE
	    XORLW	    0X56
	    BTFSC	    STATUS,2		;IF RECEIVED BYTE IS DEVICE VERIFICATION COMMAND, GOTO DEVICEVERIFICATION STATUS, Z
	    GOTO	    DEVICEVERIFICATION
	    
	    MOVF	    UART_RX_BYTE, W	
	    XORLW	    0X57
	    BTFSC	    STATUS,2		;IF RECEIVED BYTE IS Write I2C, GOTO GET_I2C_WRITE_DATA
	    GOTO	    GET_I2C_WRITE_DATA
	    
	    MOVF	    UART_RX_BYTE, W	
	    XORLW	    0X52
	    BTFSC	    STATUS,2		;IF RECEIVED BYTE IS Read I2C, GOTO GET_I2C_READ_DATA
	    GOTO	    GET_I2C_READ_DATA
	    
	    MOVF	    UART_RX_BYTE, W	
	    XORLW	    0X43
	    BTFSC	    STATUS,2		;IF RECEIVED BYTE IS Update Player Color, GOTO UPDATE_PLAYER_COLOR
	    GOTO	    UPDATE_PLAYER_COLOR ;STIL NEED TO DO
	    
	    BANKSEL	    TX1REG
	    BTFSS	    TRMT
	    GOTO	    $-1
	    MOVLW	    0x24 ;SENDS THE DOLLAR HANDSHAKE
	    MOVWF	    TX1REG
	    
	    BTFSS	    TRMT
	    GOTO	    $-1
	    MOVLW	    0x55 ;U FOR UNABLE TO PERFORM COMMAND
	    MOVWF	    TX1REG

	    RETURN
	    
	    ;THE DEVICE VERIFICATION COMMAND WAS RECEIVED, RESPOND WITH HANDSHAKE BYTE AND FIRST BYTE OF VERIFICATION
	    DEVICEVERIFICATION:
		BANKSEL	    TX1REG
		BTFSS	    TRMT
		GOTO	    $-1
		MOVLW	    0x24 ;SENDS THE DOLLAR HANDSHAKE
		MOVWF	    TX1REG
    
		BTFSS	    TRMT
		GOTO	    $-1
		MOVLW	    0x4C		;TRANSMIT SECOND BYTE OF DEVICE VERIFICATION
		MOVWF	    TX1REG

		BTFSS	    TRMT
		GOTO	    $-1
		MOVLW	    0x41		;TRANSMIT SECOND BYTE OF DEVICE VERIFICATION
		MOVWF	    TX1REG
		
		
		BTFSS	    TRMT
		GOTO	    $-1
		MOVLW	    0x4D		;TRANSMIT SECOND BYTE OF DEVICE VERIFICATION
		MOVWF	    TX1REG	
		RETURN
		
	    ;THE DEVICE VERIFICATION COMMAND WAS RECEIVED, RESPOND WITH HANDSHAKE BYTE AND FIRST BYTE OF VERIFICATION
	    GET_I2C_WRITE_DATA:
		CALL	    RECEIVE_BYTE
		BANKSEL	    PORTA
		MOVWF	    CURRENT_ADDRESS	;STORES THE ADDRESS IN A REGISTER TO SEND OUT LATER
		
		CALL	    RECEIVE_BYTE
		BANKSEL	    PORTA
		MOVWF	    WRITE_DATA		;STORES THE DATA IN A REGISTER TO SEND OUT LATER
		
		CALL WRITE_I2C
		
		BTFSS	    TRMT
		GOTO	    $-1
		MOVLW	    0x24		;TRANSMIT SECOND BYTE OF DEVICE VERIFICATION
		MOVWF	    TX1REG	
		
		BTFSS	    TRMT
		GOTO	    $-1
		MOVLW	    0x41		;TRANSMIT SECOND BYTE OF DEVICE VERIFICATION
		MOVWF	    TX1REG	
		RETURN
	    
	    ;THE DEVICE VERIFICATION COMMAND WAS RECEIVED, RESPOND WITH HANDSHAKE BYTE AND FIRST BYTE OF VERIFICATION
	    GET_I2C_READ_DATA:
		CALL	    RECEIVE_BYTE
		BANKSEL	    PORTA
		MOVWF	    CURRENT_ADDRESS	;STORES THE ADDRESS IN A REGISTER TO SEND OUT LATER
		CALL	    READ_TARGET_STATUS ;
		RETURN
			
	    ;THE DEVICE VERIFICATION COMMAND WAS RECEIVED, RESPOND WITH HANDSHAKE BYTE AND FIRST BYTE OF VERIFICATION
	    READ_SETTINGS:
;
		RETURN

	    ;THE DEVICE VERIFICATION COMMAND WAS RECEIVED, RESPOND WITH HANDSHAKE BYTE AND FIRST BYTE OF VERIFICATION
	    UPDATE_PLAYER_COLOR:
		CALL	    RECEIVE_BYTE
		BANKSEL	    PORTA
		MOVWF	    PLAYER_NUMBER	;STORES THE ADDRESS IN A REGISTER TO SEND OUT LATER
		
		CALL	    RECEIVE_BYTE
		BANKSEL	    PORTA
		MOVWF	    GREEN		;STORES THE DATA IN A REGISTER TO SEND OUT LATER
		
		CALL	    RECEIVE_BYTE
		BANKSEL	    PORTA
		MOVWF	    RED			;STORES THE DATA IN A REGISTER TO SEND OUT LATER
		
		CALL	    RECEIVE_BYTE
		BANKSEL	    PORTA
		MOVWF	    BLUE		;STORES THE DATA IN A REGISTER TO SEND OUT LATER		
		RETURN
	
	    ;THE DEVICE VERIFICATION COMMAND WAS RECEIVED, RESPOND WITH HANDSHAKE BYTE AND FIRST BYTE OF VERIFICATION
	    CALIBRATE_POSITIONS:
	    BANKSEL	    TX1REG
	    BTFSC	    TRMT
	    GOTO	    $-1
	    MOVLW	    0x24 ;SENDS THE DOLLAR HANDSHAKE
	    MOVWF	    TX1REG

	    BTFSC	    TRMT
	    GOTO	    $-1
	    MOVLW	    0x52 ;R
	    MOVWF	    TX1REG
		RETURN
	
	    ;THE DEVICE VERIFICATION COMMAND WAS RECEIVED, RESPOND WITH HANDSHAKE BYTE AND FIRST BYTE OF VERIFICATION
	    UPDATE_LEDS:
		CALL	    RECEIVE_BYTE
		BANKSEL	    PORTA
		MOVWF	    LED_NUMBER		;STORES THE DATA IN A REGISTER TO SEND OUT LATER	
		RETURN
		
	    ;THE DEVICE VERIFICATION COMMAND WAS RECEIVED, RESPOND WITH HANDSHAKE BYTE AND FIRST BYTE OF VERIFICATION
	    RECEIVE_BYTE:
		BANKSEL	    PIR1
		;BCF	    PIR1, 5
		BTFSS	    PIR1, 5		;POLLS ITSELF TO ENSURE THE BYTE WAS RECEIVED
		GOTO	    $-1
		BANKSEL	    RC1REG
		MOVF	    RC1REG, W		;MOVES THE RECEIVED BYTE INTO W
		RETURN
		
		
		
	;THE ENABLE COMMAND WAS RECEIVED, INCLUSIVE OR THE THIRD RECEIVED BYTE WITH THE ENABLE_TARGET REGISTER
	ENABLECOMMAND:
	    BANKSEL	    RC1REG
	    MOVF	    RC1REG, W		;RETRIEVE THE ENABLE BYTE
	    BANKSEL	    PORTA
	    IORWF	    ENABLE_TARGET, W	;OR THE ENABLE BYTE WITH THE ENABLE_TARGET REGISTER
	    MOVWF	    ENABLE_TARGET
	    BCF		    UART_MODE, 4	;CLEAR ENABLE FLAG
	    RETURN
	    
	;THE DISABLE COMMAND WAS RECEIVED, INCLUSIVE OR THE THIRD RECEIVED BYTE WITH THE DISABLE_TARGET REGISTER
	DISABLECOMMAND:
	    BANKSEL	    RC1REG
	    MOVF	    RC1REG, W		;RETRIEVE THE DISABLE BYTE
	    BANKSEL	    PORTA
	    IORWF	    DISABLE_TARGET, f	;OR THE DISABLE BYTE WITH THE DISABLE_TARGET REGISTER
	    BCF		    UART_MODE, 3	;CLEAR DISABLE FLAG
	    RETURN
	    
	;THE CLEAR COMMAND WAS RECEIVED, MOVE A 0XFF INTO DISABLE_TARGET
	CLEARTARGETS:
	    BANKSEL	    PORTA
	    MOVLW	    0XFF
	    MOVWF	    DISABLE_TARGET	;SET DISABLE FLAGS FOR ALL TARGETS
	    RETURN
	    
	;THE CHANGE SLOT ADDRESS COMMAND WAS RECEIVED, STORE THE THIRD BYTE RECEIVED IN THE CHANGE_SLOT REGISTER
	STORECHANGESLOT:
	    BANKSEL	    RC1REG
	    MOVF	    RC1REG, W		;RETRIEVE THE CHANGE SLOT
	    BANKSEL	    PORTA
	    MOVWF	    CHANGE_SLOT		;STORE THE CHANGE SLOT
	    BCF		    UART_MODE, 2	;CLEAR CHANGE FLAG
	    BSF		    UART_MODE, 1	;SET SLOT FLAG
	    RETURN
	    
	;THE CHANGE SLOT ADDRESS COMMAND WAS RECEIVED, STORE THE FOURTH BYTE RECEIVED IN THE CORRESPONDING TARGET SLOT
	CHANGESLOTADDRESS:
	    BANKSEL	    RC1REG
	    MOVF	    RC1REG, W		;RETRIEVE THE I2C ADDRESS
	    BANKSEL	    PORTA
	    BCF		    UART_MODE, 1	;CLEAR THE SLOT FLAG
	    BTFSC	    CHANGE_SLOT, 7	;GOTO CHANGETARGET ASSOCIATED WITH CHANGE SLOT BIT
	    GOTO	    CHANGETARGETONE
	    BTFSC	    CHANGE_SLOT, 6
	    GOTO	    CHANGETARGETTWO
	    BTFSC	    CHANGE_SLOT, 5
	    GOTO	    CHANGETARGETTHREE
	    BTFSC	    CHANGE_SLOT, 4
	    GOTO	    CHANGETARGETFOUR
	    BTFSC	    CHANGE_SLOT, 3
	    GOTO	    CHANGETARGETFIVE
	    BTFSC	    CHANGE_SLOT, 2
	    GOTO	    CHANGETARGETSIX
	    BTFSC	    CHANGE_SLOT, 1
	    GOTO	    CHANGETARGETSEVEN
	    BTFSC	    CHANGE_SLOT, 0
	    GOTO	    CHANGETARGETEIGHT
	    RETURN
	    
	CHANGETARGETONE:
	    BTFSC	    INUSE_TARGET, 7	;IF THE TARGET IS CURRENTLY IN USE, RETURN
	    RETURN
	    BANKSEL	    PORTA
	    MOVWF	    TGT_ONE_ADDRESS	;ELSE UPDATE THE TARGET SLOT ADDRESS
	    RETURN
	    
	CHANGETARGETTWO:
	    BTFSC	    INUSE_TARGET, 6	;IF THE TARGET IS CURRENTLY IN USE, RETURN
	    RETURN
	    BANKSEL	    PORTA
	    MOVWF	    TGT_TWO_ADDRESS	;ELSE UPDATE THE TARGET SLOT ADDRESS
	    RETURN
	    
	CHANGETARGETTHREE:
	    BTFSC	    INUSE_TARGET, 5	;IF THE TARGET IS CURRENTLY IN USE, RETURN
	    RETURN
	    BANKSEL	    PORTA
	    MOVWF	    TGT_THREE_ADDRESS	;ELSE UPDATE THE TARGET SLOT ADDRESS
	    RETURN
	    
	CHANGETARGETFOUR:
	    BTFSC	    INUSE_TARGET, 4	;IF THE TARGET IS CURRENTLY IN USE, RETURN
	    RETURN
	    BANKSEL	    PORTA
	    MOVWF	    TGT_FOUR_ADDRESS	;ELSE UPDATE THE TARGET SLOT ADDRESS
	    RETURN
	    
	CHANGETARGETFIVE:
	    BTFSC	    INUSE_TARGET, 3	;IF THE TARGET IS CURRENTLY IN USE, RETURN
	    RETURN
	    BANKSEL	    PORTA
	    MOVWF	    TGT_FIVE_ADDRESS	;ELSE UPDATE THE TARGET SLOT ADDRESS
	    RETURN
	    
	CHANGETARGETSIX:
	    BTFSC	    INUSE_TARGET, 2	;IF THE TARGET IS CURRENTLY IN USE, RETURN
	    RETURN
	    BANKSEL	    PORTA
	    MOVWF	    TGT_SIX_ADDRESS	;ELSE UPDATE THE TARGET SLOT ADDRESS
	    RETURN
	    
	CHANGETARGETSEVEN:
	    BTFSC	    INUSE_TARGET, 1	;IF THE TARGET IS CURRENTLY IN USE, RETURN
	    RETURN
	    BANKSEL	    PORTA
	    MOVWF	    TGT_SEVEN_ADDRESS	;ELSE UPDATE THE TARGET SLOT ADDRESS
	    RETURN
	    
	CHANGETARGETEIGHT:
	    BTFSC	    INUSE_TARGET, 0	;IF THE TARGET IS CURRENTLY IN USE, RETURN
	    RETURN
	    BANKSEL	    PORTA
	    MOVWF	    TGT_EIGHT_ADDRESS	;ELSE UPDATE THE TARGET SLOT ADDRESS
	    RETURN
	   
    ;THE UART TX INTERRUPT HAS OCCURED, IF THE VERIFY FLAG IS SET, SEND THE LAST BYTE OF THE VERIFY COMMAND
    ;IF THE PLAYER FLAG IS SET, SEND THE SCORING PLAYER NUMBER
    UARTTX:
	    BANKSEL	    PIE1
	    BCF TXIE		;DISABLE UART TX INTERRUPT
	    BTFSC TXIE
	    GOTO	    $-2
	    BANKSEL	    PORTA
	    BTFSC	    UART_MODE, 6	;IF THE VERIFY FLAG IS SET, GOTO TXVERIFY
	    GOTO	    TXVERIFY
	    BTFSC	    UART_MODE, 5	;IF THE PLAYER FLAG IS SET, GOTO TXVERIFY
	    GOTO	    TXPLAYER
	    RETURN    
	TXVERIFY:
	    BANKSEL	    TX1REG
	    MOVLW	    0X41
	    MOVWF	    TX1REG		;TRANSMIT THE THIRD BYTE OF DEVICE VERIFICATION
	    ;MOVLW	    0X4D
	    MOVLW	    0X44
	    MOVWF	    TX1REG		;TRANSMIT THE FOURTH BYTE OF DEVICE VERIFICATION
	    BANKSEL	    PORTA
	    BCF		    UART_MODE, 6	;CLEAR THE VERIFY FLAG
	    RETURN
	TXPLAYER:
	    BANKSEL	    PORTA
	    BCF		    UART_MODE, 5	;CLEAR PLAYER FLAG
	    MOVF	    SCORE_PLAYER, W
	    BANKSEL	    TX1REG
	    MOVWF	    TX1REG		;TRANSMIT THE SCORING PLAYER NUMBER
	    RETURN
	    
    ;A PLAYER HAS SCORED, SEND THE HANDSHAKE BYTE AND I2C ADDRESS OF THE SCORED TARGET VIA UART. SET THE PLAYER FLAG FOR THE TX INTERRUPT
    UARTSENDSCORE:
	    BANKSEL	    TX1REG
	    MOVLW	    0X24
	    MOVWF	    TX1REG		;TRANSMIT HANDSHAKE BYTE
	    BANKSEL	    PORTA
	    MOVF	    SCORE_ADDRESS, W
	    BANKSEL	    TX1REG
	    MOVWF	    TX1REG		;TRANSMIT I2C ADDRESS OF SCORED TARGET
	    BANKSEL	    PORTA
	    BSF		    UART_MODE, 5	;SET THE PLAYER FLAG FOR NEXT TX INTERRUPT
	    BANKSEL	    PIE1
	    BSF TXIE		;ENABLE THE UART TRANSMIT INTERRUPT
	    RETURN
	    
	    
    ;CALLED IN MAIN TO EITHER ENABLE, DISABLE, OR POLL TARGET SLOT ONE
    UPDATETARGETONE:
	    BANKSEL	    PORTA		
	    MOVF	    TGT_ONE_ADDRESS,0	;MOVE AN ADDRESS TO THE CURRENT_ADDRESS REGISTER
	    MOVWF	    CURRENT_ADDRESS
	    BTFSC	    ENABLE_TARGET, 7	;IF THE TARGET IS REQUESTED TO BE ENABLED, SEND THE ENABLE COMMAND
	    GOTO	    ENABLETARGETONE
	    BTFSC	    DISABLE_TARGET, 7	;IF THE TARGET IS REQUESTED TO BE DISABLED, SEND THE DISABLE COMMAND
	    GOTO	    DISABLETARGETONE
	    BTFSC	    INUSE_TARGET, 7	;IF THE TARGET IS CURRENTLY IN USE, POLL THE TARGET
	    GOTO	    POLLTARGETONE
	    RETURN
	ENABLETARGETONE:
	    BANKSEL	    PORTA
	    MOVLW	    0X45		;MOVE AN ENABLE TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    ENABLE_TARGET, 7	;CLEAR THE ENABLE TARGET FLAG
	    BSF		    INUSE_TARGET, 7	;MARK THE TARGET AS IN USE
	    RETURN
	DISABLETARGETONE:
	    BANKSEL	    PORTA
	    MOVLW	    0X44		;MOVE A LETTER D TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    DISABLE_TARGET, 7	;CLEAR THE DISABLE TARGET FLAG
	    BCF		    INUSE_TARGET, 7	;MARK THE TARGET AS NO LONGER IN USE
	    RETURN
	POLLTARGETONE:
	    CALL	    READ_TARGET_STATUS	;ASK IF THE TARGET HAS BEEN SCORED ON
	    XORLW	    0XFF		;IF THE TARGET HAD A SCORE, W RETURNED WITH 0XFF
	    BANKSEL	    PORTA
	    BTFSC	    STATUS,2		;IF A SCORE WAS RECORDED, CLEAR THE INUSE TARGET FLAG
	    BCF		    INUSE_TARGET, 7	;TARGET AUTOMATICALLY DISABLED ITSELF
	    RETURN
	    
	    
    ;CALLED IN MAIN TO EITHER ENABLE, DISABLE, OR POLL TARGET SLOT TWO
    UPDATETARGETTWO:
	    BANKSEL	    PORTA		
	    MOVF	    TGT_TWO_ADDRESS,0	;MOVE AN ADDRESS TO THE CURRENT_ADDRESS REGISTER
	    MOVWF	    CURRENT_ADDRESS
	    BTFSC	    ENABLE_TARGET, 6	;IF THE TARGET IS REQUESTED TO BE ENABLED, SEND THE ENABLE COMMAND
	    GOTO	    ENABLETARGETTWO
	    BTFSC	    DISABLE_TARGET, 6	;IF THE TARGET IS REQUESTED TO BE DISABLED, SEND THE DISABLE COMMAND
	    GOTO	    DISABLETARGETTWO
	    BTFSC	    INUSE_TARGET, 6	;IF THE TARGET IS CURRENTLY IN USE, POLL THE TARGET
	    GOTO	    POLLTARGETTWO
	    RETURN
	ENABLETARGETTWO:
	    BANKSEL	    PORTA
	    MOVLW	    0X45		;MOVE AN ENABLE TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    ENABLE_TARGET, 6	;CLEAR THE ENABLE TARGET FLAG
	    BSF		    INUSE_TARGET, 6	;MARK THE TARGET AS IN USE
	    RETURN
	DISABLETARGETTWO:
	    BANKSEL	    PORTA
	    MOVLW	    0X44		;MOVE A LETTER D TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    DISABLE_TARGET, 6	;CLEAR THE DISABLE TARGET FLAG
	    BCF		    INUSE_TARGET, 6	;MARK THE TARGET AS NO LONGER IN USE
	    RETURN
	POLLTARGETTWO:
	    CALL	    READ_TARGET_STATUS	;ASK IF THE TARGET HAS BEEN SCORED ON
	    XORLW	    0XFF		;IF THE TARGET HAD A SCORE, W RETURNED WITH 0XFF
	    BANKSEL	    PORTA
	    BTFSC	    STATUS,2		;IF A SCORE WAS RECORDED, CLEAR THE INUSE TARGET FLAG
	    BCF		    INUSE_TARGET, 6	;TARGET AUTOMATICALLY DISABLED ITSELF
	    RETURN
	    
	    
    ;CALLED IN MAIN TO EITHER ENABLE, DISABLE, OR POLL TARGET SLOT THREE
    UPDATETARGETTHREE:
	    BANKSEL	    PORTA		
	    MOVF	    TGT_THREE_ADDRESS,0	;MOVE AN ADDRESS TO THE CURRENT_ADDRESS REGISTER
	    MOVWF	    CURRENT_ADDRESS
	    BTFSC	    ENABLE_TARGET, 5	;IF THE TARGET IS REQUESTED TO BE ENABLED, SEND THE ENABLE COMMAND
	    GOTO	    ENABLETARGETTHREE
	    BTFSC	    DISABLE_TARGET, 5	;IF THE TARGET IS REQUESTED TO BE DISABLED, SEND THE DISABLE COMMAND
	    GOTO	    DISABLETARGETTHREE
	    BTFSC	    INUSE_TARGET, 5	;IF THE TARGET IS CURRENTLY IN USE, POLL THE TARGET
	    GOTO	    POLLTARGETTHREE
	    RETURN
	ENABLETARGETTHREE:
	    BANKSEL	    PORTA
	    MOVLW	    0X45		;MOVE AN ENABLE TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    ENABLE_TARGET, 5	;CLEAR THE ENABLE TARGET FLAG
	    BSF		    INUSE_TARGET, 5	;MARK THE TARGET AS IN USE
	    RETURN
	DISABLETARGETTHREE:
	    BANKSEL	    PORTA
	    MOVLW	    0X44		;MOVE A LETTER D TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    DISABLE_TARGET, 5	;CLEAR THE DISABLE TARGET FLAG
	    BCF		    INUSE_TARGET, 5	;MARK THE TARGET AS NO LONGER IN USE
	    RETURN
	POLLTARGETTHREE:
	    CALL	    READ_TARGET_STATUS	;ASK IF THE TARGET HAS BEEN SCORED ON
	    XORLW	    0XFF		;IF THE TARGET HAD A SCORE, W RETURNED WITH 0XFF
	    BANKSEL	    PORTA
	    BTFSC	    STATUS,2		;IF A SCORE WAS RECORDED, CLEAR THE INUSE TARGET FLAG
	    BCF		    INUSE_TARGET, 5	;TARGET AUTOMATICALLY DISABLED ITSELF
	    RETURN
	    
	    
    ;CALLED IN MAIN TO EITHER ENABLE, DISABLE, OR POLL TARGET SLOT FOUR
    UPDATETARGETFOUR:
	    BANKSEL	    PORTA		
	    MOVF	    TGT_FOUR_ADDRESS,0	;MOVE AN ADDRESS TO THE CURRENT_ADDRESS REGISTER
	    MOVWF	    CURRENT_ADDRESS
	    BTFSC	    ENABLE_TARGET, 4	;IF THE TARGET IS REQUESTED TO BE ENABLED, SEND THE ENABLE COMMAND
	    GOTO	    ENABLETARGETFOUR
	    BTFSC	    DISABLE_TARGET, 4	;IF THE TARGET IS REQUESTED TO BE DISABLED, SEND THE DISABLE COMMAND
	    GOTO	    DISABLETARGETFOUR
	    BTFSC	    INUSE_TARGET, 4	;IF THE TARGET IS CURRENTLY IN USE, POLL THE TARGET
	    GOTO	    POLLTARGETFOUR
	    RETURN
	ENABLETARGETFOUR:
	    BANKSEL	    PORTA
	    MOVLW	    0X45		;MOVE AN ENABLE TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    ENABLE_TARGET, 4	;CLEAR THE ENABLE TARGET FLAG
	    BSF		    INUSE_TARGET, 4	;MARK THE TARGET AS IN USE
	    RETURN
	DISABLETARGETFOUR:
	    BANKSEL	    PORTA
	    MOVLW	    0X44		;MOVE A LETTER D TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    DISABLE_TARGET, 4	;CLEAR THE DISABLE TARGET FLAG
	    BCF		    INUSE_TARGET, 4	;MARK THE TARGET AS NO LONGER IN USE
	    RETURN
	POLLTARGETFOUR:
	    CALL	    READ_TARGET_STATUS	;ASK IF THE TARGET HAS BEEN SCORED ON
	    XORLW	    0XFF		;IF THE TARGET HAD A SCORE, W RETURNED WITH 0XFF
	    BANKSEL	    PORTA
	    BTFSC	    STATUS,2		;IF A SCORE WAS RECORDED, CLEAR THE INUSE TARGET FLAG
	    BCF		    INUSE_TARGET, 4	;TARGET AUTOMATICALLY DISABLED ITSELF
	    RETURN
	    
	    
    ;CALLED IN MAIN TO EITHER ENABLE, DISABLE, OR POLL TARGET SLOT FIVE
    UPDATETARGETFIVE:
	    BANKSEL	    PORTA		
	    MOVF	    TGT_FIVE_ADDRESS,0	;MOVE AN ADDRESS TO THE CURRENT_ADDRESS REGISTER
	    MOVWF	    CURRENT_ADDRESS
	    BTFSC	    ENABLE_TARGET, 3	;IF THE TARGET IS REQUESTED TO BE ENABLED, SEND THE ENABLE COMMAND
	    GOTO	    ENABLETARGETFIVE
	    BTFSC	    DISABLE_TARGET, 3	;IF THE TARGET IS REQUESTED TO BE DISABLED, SEND THE DISABLE COMMAND
	    GOTO	    DISABLETARGETFIVE
	    BTFSC	    INUSE_TARGET, 3	;IF THE TARGET IS CURRENTLY IN USE, POLL THE TARGET
	    GOTO	    POLLTARGETFIVE
	    RETURN
	ENABLETARGETFIVE:
	    BANKSEL	    PORTA
	    MOVLW	    0X45		;MOVE AN ENABLE TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    ENABLE_TARGET, 3	;CLEAR THE ENABLE TARGET FLAG
	    BSF		    INUSE_TARGET, 3	;MARK THE TARGET AS IN USE
	    RETURN
	DISABLETARGETFIVE:
	    BANKSEL	    PORTA
	    MOVLW	    0X44		;MOVE A LETTER D TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    DISABLE_TARGET, 3	;CLEAR THE DISABLE TARGET FLAG
	    BCF		    INUSE_TARGET, 3	;MARK THE TARGET AS NO LONGER IN USE
	    RETURN
	POLLTARGETFIVE:
	    CALL	    READ_TARGET_STATUS	;ASK IF THE TARGET HAS BEEN SCORED ON
	    XORLW	    0XFF		;IF THE TARGET HAD A SCORE, W RETURNED WITH 0XFF
	    BANKSEL	    PORTA
	    BTFSC	    STATUS,2		;IF A SCORE WAS RECORDED, CLEAR THE INUSE TARGET FLAG
	    BCF		    INUSE_TARGET, 3	;TARGET AUTOMATICALLY DISABLED ITSELF
	    RETURN
	    
	    
    ;CALLED IN MAIN TO EITHER ENABLE, DISABLE, OR POLL TARGET SLOT SIX
    UPDATETARGETSIX:
	    BANKSEL	    PORTA		
	    MOVF	    TGT_SIX_ADDRESS,0	;MOVE AN ADDRESS TO THE CURRENT_ADDRESS REGISTER
	    MOVWF	    CURRENT_ADDRESS
	    BTFSC	    ENABLE_TARGET, 2	;IF THE TARGET IS REQUESTED TO BE ENABLED, SEND THE ENABLE COMMAND
	    GOTO	    ENABLETARGETSIX
	    BTFSC	    DISABLE_TARGET, 2	;IF THE TARGET IS REQUESTED TO BE DISABLED, SEND THE DISABLE COMMAND
	    GOTO	    DISABLETARGETSIX
	    BTFSC	    INUSE_TARGET, 2	;IF THE TARGET IS CURRENTLY IN USE, POLL THE TARGET
	    GOTO	    POLLTARGETSIX
	    RETURN
	ENABLETARGETSIX:
	    BANKSEL	    PORTA
	    MOVLW	    0X45		;MOVE AN ENABLE TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    ENABLE_TARGET, 2	;CLEAR THE ENABLE TARGET FLAG
	    BSF		    INUSE_TARGET, 2	;MARK THE TARGET AS IN USE
	    RETURN
	DISABLETARGETSIX:
	    BANKSEL	    PORTA
	    MOVLW	    0X44		;MOVE A LETTER D TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    DISABLE_TARGET, 2	;CLEAR THE DISABLE TARGET FLAG
	    BCF		    INUSE_TARGET, 2	;MARK THE TARGET AS NO LONGER IN USE
	    RETURN
	POLLTARGETSIX:
	    CALL	    READ_TARGET_STATUS	;ASK IF THE TARGET HAS BEEN SCORED ON
	    XORLW	    0XFF		;IF THE TARGET HAD A SCORE, W RETURNED WITH 0XFF
	    BANKSEL	    PORTA
	    BTFSC	    STATUS,2		;IF A SCORE WAS RECORDED, CLEAR THE INUSE TARGET FLAG
	    BCF		    INUSE_TARGET, 2	;TARGET AUTOMATICALLY DISABLED ITSELF
	    RETURN
	    
	    
    ;CALLED IN MAIN TO EITHER ENABLE, DISABLE, OR POLL TARGET SLOT SEVEN
    UPDATETARGETSEVEN:
	    BANKSEL	    PORTA		
	    MOVF	    TGT_SEVEN_ADDRESS,0	;MOVE AN ADDRESS TO THE CURRENT_ADDRESS REGISTER
	    MOVWF	    CURRENT_ADDRESS
	    BTFSC	    ENABLE_TARGET, 1	;IF THE TARGET IS REQUESTED TO BE ENABLED, SEND THE ENABLE COMMAND
	    GOTO	    ENABLETARGETSEVEN
	    BTFSC	    DISABLE_TARGET, 1	;IF THE TARGET IS REQUESTED TO BE DISABLED, SEND THE DISABLE COMMAND
	    GOTO	    DISABLETARGETSEVEN
	    BTFSC	    INUSE_TARGET, 1	;IF THE TARGET IS CURRENTLY IN USE, POLL THE TARGET
	    GOTO	    POLLTARGETSEVEN
	    RETURN
	ENABLETARGETSEVEN:
	    BANKSEL	    PORTA
	    MOVLW	    0X45		;MOVE AN ENABLE TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    ENABLE_TARGET, 1	;CLEAR THE ENABLE TARGET FLAG
	    BSF		    INUSE_TARGET, 1	;MARK THE TARGET AS IN USE
	    RETURN
	DISABLETARGETSEVEN:
	    BANKSEL	    PORTA
	    MOVLW	    0X44		;MOVE A LETTER D TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    DISABLE_TARGET, 1	;CLEAR THE DISABLE TARGET FLAG
	    BCF		    INUSE_TARGET, 1	;MARK THE TARGET AS NO LONGER IN USE
	    RETURN
	POLLTARGETSEVEN:
	    CALL	    READ_TARGET_STATUS	;ASK IF THE TARGET HAS BEEN SCORED ON
	    XORLW	    0XFF		;IF THE TARGET HAD A SCORE, W RETURNED WITH 0XFF
	    BANKSEL	    PORTA
	    BTFSC	    STATUS,2		;IF A SCORE WAS RECORDED, CLEAR THE INUSE TARGET FLAG
	    BCF		    INUSE_TARGET, 1	;TARGET AUTOMATICALLY DISABLED ITSELF
	    RETURN
	    
	    
    ;CALLED IN MAIN TO EITHER ENABLE, DISABLE, OR POLL TARGET SLOT EIGHT
    UPDATETARGETEIGHT:
	    BANKSEL	    PORTA		
	    MOVF	    TGT_EIGHT_ADDRESS,0	;MOVE AN ADDRESS TO THE CURRENT_ADDRESS REGISTER
	    MOVWF	    CURRENT_ADDRESS
	    BTFSC	    ENABLE_TARGET, 0	;IF THE TARGET IS REQUESTED TO BE ENABLED, SEND THE ENABLE COMMAND
	    GOTO	    ENABLETARGETEIGHT
	    BTFSC	    DISABLE_TARGET, 0	;IF THE TARGET IS REQUESTED TO BE DISABLED, SEND THE DISABLE COMMAND
	    GOTO	    DISABLETARGETEIGHT
	    BTFSC	    INUSE_TARGET, 0	;IF THE TARGET IS CURRENTLY IN USE, POLL THE TARGET
	    GOTO	    POLLTARGETEIGHT
	    RETURN
	ENABLETARGETEIGHT:
	    BANKSEL	    PORTA
	    MOVLW	    0X45		;MOVE AN ENABLE TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    ENABLE_TARGET, 0	;CLEAR THE ENABLE TARGET FLAG
	    BSF		    INUSE_TARGET, 0	;MARK THE TARGET AS IN USE
	    RETURN
	DISABLETARGETEIGHT:
	    BANKSEL	    PORTA
	    MOVLW	    0X44		;MOVE A LETTER D TO THE WRITE_DATA REGISTER
	    MOVWF	    WRITE_DATA
	    CALL	    WRITE_I2C		;CALL THE WRITE_I2C SUBROUTINE TO ENABLE THE TARGET
	    BANKSEL	    PORTA
	    BCF		    DISABLE_TARGET, 0	;CLEAR THE DISABLE TARGET FLAG
	    BCF		    INUSE_TARGET, 0	;MARK THE TARGET AS NO LONGER IN USE
	    RETURN
	POLLTARGETEIGHT:
	    CALL	    READ_TARGET_STATUS	;ASK IF THE TARGET HAS BEEN SCORED ON
	    XORLW	    0XFF		;IF THE TARGET HAD A SCORE, W RETURNED WITH 0XFF
	    BANKSEL	    PORTA
	    BTFSC	    STATUS,2		;IF A SCORE WAS RECORDED, CLEAR THE INUSE TARGET FLAG
	    BCF		    INUSE_TARGET, 0	;TARGET AUTOMATICALLY DISABLED ITSELF
	    RETURN
	    

		